# yandex_practicum_ds_supervised_learning_user_activity_prediction_n5

# Интернет-магазин «В один клик»: Прогнозирование активности покупателей

## Введение

**Анекдот:**  
-- Вот открою рыбный магазинчик! Буду лед продавать по цене рыбы.

**Цель работы:**  
Интернет-магазин «В один клик» продаёт товары для детей, для дома, бытовую технику, косметику и даже продукты. По итогам отчёта за прошлый период было выявлено снижение активности покупателей. Привлечение новых клиентов оказалось неэффективным, поэтому компания решила удерживать постоянных клиентов посредством персонализированных предложений. Задача проекта – разработать модель, которая предскажет вероятность снижения покупательской активности в следующие три месяца и позволит сформировать сегменты клиентов для дальнейшего предложения персонализированных акций.

**Задача руководителя отдела DS:**  
- Промаркировать уровень финансовой активности постоянных покупателей по двум категориям: «снизилась» (покупки уменьшились) и «прежний уровень».
- Собрать данные по следующим группам:
  - Коммуникация с клиентом (рассылки, звонки, показы рекламы);
  - Продуктовое поведение (какие товары и как часто покупает);
  - Покупательское поведение (суммы расходов);
  - Поведение на сайте (количество просмотренных страниц, время на сайте).
- Дополнительно включить данные о прибыльности клиентов за последние три месяца для сегментирования и разработки персональных предложений.

## Данные

Проект использует четыре основных датасета:

- **market_file.csv**  
  Содержит данные о поведении покупателей на сайте, коммуникации и продуктовом поведении.  
  Основные признаки:  
  • `id` – идентификатор клиента  
  • `Покупательская активность` – целевой признак («снизилась» или «прежний уровень»)  
  • `Тип сервиса`, `Разрешить сообщать`  
  • `Маркет_актив_6_мес`, `Маркет_актив_тек_мес`  
  • `Длительность` регистрации  
  • `Акционные_покупки`, `Популярная_категория`  
  • `Средний_просмотр_категорий_за_визит`  
  • `Неоплаченные_продукты_штук_квартал`  
  • `Ошибка_сервиса`, `Страниц_за_визит`

- **market_money.csv**  
  Содержит данные о выручке магазина: периоды (текущий, предыдущий, предпредыдущий месяцы) и выручка за каждый период.

- **market_time.csv**  
  Отражает время (в минутах), проведённое пользователями на сайте, распределённое по периодам.

- **money.csv**  
  Содержит данные о среднемесячной прибыли от каждого покупателя за последние 3 месяца.

## Обзор проделанной работы

В ходе проекта выполнено:

1. **Знакомство с данными**  
   - Выявлены особенности распределения и корректность данных.  
   - Обнаружены и исправлены ошибки в типах данных и значениях категориальных переменных (например, опечатки в значениях `Тип сервиса` и `Период`).

2. **Предобработка данных**  
   - Приведение типов (числовых значений, дат).  
   - Корректировка категориальных значений.  
   - Проверка и удаление выбросов (например, в столбце Выручка).  
   - Отсутствие явных пропусков и дубликатов.

3. **Исследовательский анализ данных (EDA)**  
   - Анализ распределения признаков (кол-во маркетинговых активностей, длительность регистрации, доля акционных покупок, количество страниц за визит и др.).  
   - Сравнительный анализ активных пользователей по разным таблицам (market_file, market_money, market_time, money).

4. **Объединение таблиц**  
   - Интеграция данных из market_file, market_money и market_time в итоговую таблицу `market_active`.  
   - Добавление новых столбцов: выручка за предпредыдущий, предыдущий и текущий месяцы, а также время на сайте за соответствующие периоды.

5. **Корреляционный анализ**  
   - Выделение количественных и категориальных признаков.  
   - Применение коэффициента корреляции Спирмена для количественных переменных.  
   - Выявление, что мультиколлинеарности нет (коэффициенты < 0.9).  
   - Анализ взаимосвязей между такими признаками, как маркетинговая активность, просмотры страниц, неоплаченные товары и пр.

6. **Обучение модели и выбор лучшей модели**  
   - Выделение целевых и обучающих признаков, стратифицированное разбиение выборки (75:25).  
   - Применение различных алгоритмов (Decision Tree, KNN, Logistic Regression, SVC) с использованием One Hot и Ordinal Encoding для категориальных данных, а также нормализации числовых признаков.
   - Лучшие результаты (ROC-AUC = 0.912) достигнуты с помощью модели Logistic Regression (C=5, penalty='l1', solver='liblinear').

7. **Анализ важности признаков**  
   - Определены факторы, влияющие на удержание клиентов.  
   - К числу положительно влияющих признаков относятся: большое количество страниц и категорий за визит, длительное время на сайте, высокая маркетинговая активность (до определённого порога).  
   - Факторы, повышающие риск ухода: чрезмерное количество маркетинговых активностей, большое время на сайте в прошлом месяце, высокая частота просмотров без конвертации.

8. **Анализ определенной группы пользователей и разработка предложений**  
   - Выделена группа пользователей с высокой долей акционных покупок (более 0.6).  
   - Для данной группы выявлено, что:  
     • Выручка за предыдущий и текущий месяцы снижается;  
     • Снижается количество страниц за визит;  
     • Увеличивается число товаров в корзине.  
   - Дополнительно отмечено, что среди клиентов со сниженной активностью больше пользователей с премиум-сервисом, совершающих мелкие покупки (например, текстиль, товары для детей, посуда), в то время как активные покупатели выбирают дорогие товары (бытовая техника, техника для здоровья).

## Вывод и рекомендации

**Общий вывод:**  
Была проведена комплексная работа по анализу, предобработке, объединению данных, исследовательскому анализу, обучению модели и оценке важности признаков. На основе полученных результатов можно выделить следующие рекомендации:

- **Повысить количество маркетинговых активностей** до минимум 3 в месяц для повышения удержания клиентов.  
- **Повысить уровень сервиса** для премиум-покупателей, так как их доля среди уходящих значительно выше.  
- **Стимулировать покупателей**, совершающих мелкие покупки, переходить к более дорогим покупкам (например, бытовая техника).  
- **Разрабатывать дополнительные персонализированные акции** для клиентов с высоким числом товаров в корзине, чтобы побудить их завершить покупку.

Эти меры позволят не только прогнозировать снижение покупательской активности с высокой точностью, но и сформировать эффективную стратегию удержания клиентов для интернет-магазина «В один клик».